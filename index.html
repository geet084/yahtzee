<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0 user-scalable=no maximum-scale=1 minimum-scale=1">
  <meta name="Description" content="Yahtzee">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="theme-color" content="#547a95" />
  <link rel="apple-touch-icon" href="./images/icon-192.png">
  <link rel="stylesheet" href="index.css">
  <link rel="manifest" href="manifest.json">
  <title>Yahtzee</title>
</head>

<body>
  <main class="main-splash">
    <div class="splash-top">
      <img src="./images/logo.png" alt="game icon">
      <h1 class="title">Yahtzee</h1>
      <div class="score-record">
        <h4 class="high-scores"></h4>
        <h4 class="high-scores"></h4>
        <h4 class="high-scores"></h4>
      </div>
    </div>
    <div class="splash-btm">
      <div class="onoffswitch">
        <input type="checkbox" name="onoffswitch" class="onoffswitch-checkbox" id="myonoffswitch" checked>
        <label class="onoffswitch-label" for="myonoffswitch">
          <span class="onoffswitch-inner single"></span>
          <span class="onoffswitch-switch computer"></span>
        </label>
      </div>
      <span class="start-game">New Game</span>
    </div>
  </main>
  <main class="main-game" style="display: none">
    <article class="header">
      <span class="return top-return">⬅︎</span>
      <section class="total-score">
        <div>
          <p class="scoring">
            <i class="fas fa-user-circle"></i>
            <span id="p-ttlscore">0</span>
            <span class="spacer"></span>
          </p>
        </div>
        <div class="ttl-comp-score">
          <p class="scoring comp-score">
            <span class="divider">|</span>
            <span id="c-ttlscore">0</span>
            <i class="fas fa-robot"></i>
          </p>
        </div>
      </section>
    </article>
    <article class="scores">
      <section class="upper-section">
        <div class="dice-row">
          <span class="die one">
            <span class="pip"></span>
          </span>
          <span id="pu1" class="box player"></span>
          <span id="cu1" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die two">
            <span class="pip"></span>
            <span class="pip"></span>
          </span>
          <span id="pu2" class="box player"></span>
          <span id="cu2" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die three">
            <span class="pip"></span>
            <span class="pip"></span>
            <span class="pip"></span>
          </span>
          <span id="pu3" class="box player"></span>
          <span id="cu3" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die four">
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
          </span>
          <span id="pu4" class="box player"></span>
          <span id="cu4" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die five">
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
            <span class="pip"></span>
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
          </span>
          <span id="pu5" class="box player"></span>
          <span id="cu5" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die six">
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
            <div class="col">
              <span class="pip"></span>
              <span class="pip"></span>
              <span class="pip"></span>
            </div>
          </span>
          <span id="pu6" class="box player"></span>
          <span id="cu6" class="box comp"></span>
        </div>
      </section>
      <section class="lower">
        <div class="dice-row">
          <span class="die x3">
            3 <span class="x">x</span>
          </span>
          <span id="px3" class="box player"></span>
          <span id="cx3" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die x4">
            4 <span class="x">x</span>
          </span>
          <span id="px4" class="box player"></span>
          <span id="cx4" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die fh">
            <span class="chimney"></span>
            <span class="peak"></span>
            <span class="base"></span>
            <span class="door"></span>
          </span>
          <span id="pfh" class="box player"></span>
          <span id="cfh" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die ss">
            <span class="card card1"></span>
            <span class="card card2"></span>
            <span class="card card3"></span>
            <span class="card card4"></span>
            <span class="straight">SMALL</span>
          </span>
          <span id="pss" class="box player"></span>
          <span id="css" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die ls">
            <span class="card card1"></span>
            <span class="card card2"></span>
            <span class="card card3"></span>
            <span class="card card4"></span>
            <span class="card card5"></span>
            <span class="straight">LARGE</span>
          </span>
          <span id="pls" class="box player"></span>
          <span id="cls" class="box comp"></span>
        </div>
        <div class="dice-row">
          <span class="die x5">
            <span class="yahtzee">YAHTZEE</span>
          </span>
          <span id="px5" class="box player"></span>
          <span id="cx5" class="box comp"></span>
        </div>
      </section>
    </article>
    <article class="mid-section">
      <section class="bonus">
        <span class="bonus-title">
          Section Bonus: <span class="bonus-points">+35</span>
        </span>
        <span class="p-bonus-num">0 / 63</span>
        <span class="c-bonus-num comp">0 / 63</span>
      </section>
      <section class="chance">
        <span class="die chance-box">
          <span class="chance-title">?</span>
        </span>
        <span id="pch" class="box player"></span>
        <span id="cch" class="box comp"></span>
      </section>
    </article>
    <article class="btm-section">
      <section class="dice-area">
        <div id="rd1" class="dice dbox"></div>
        <div id="rd2" class="dice dbox"></div>
        <div id="rd3" class="dice dbox"></div>
        <div id="rd4" class="dice dbox"></div>
        <div id="rd5" class="dice dbox"></div>
      </section>
      <section class="roll-play">
        <div class="roll avail-btn">
          <span class="roll roll-title">ROLL</span>
          <span class="roll rolls roll-1"></span>
          <span class="roll rolls roll-2"></span>
          <span class="roll rolls roll-3"></span>
        </div>
        <div class="score done">PLAY</div>
      </section>
    </article>
    <article class="end-game" style="display: none">
      <div class="restart">PLAY AGAIN</div>
      <div class="return end-return">RETURN HOME</div>
    </article>
  </main>
  <div id="notification" class="notification">
    <p id='reload'>
      A new version of this app is available. Tap here to update.
    </p>
  </div>
</body>
<script type="module" src="index.js"></script>
<script src="https://kit.fontawesome.com/307c1acb36.js" crossorigin="anonymous"></script>
<script>
  let newWorker;

  document.getElementById('reload').addEventListener('click', function () {
    newWorker.postMessage({ action: 'skipWaiting' });
  });

  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('./serviceWorker.js')
      .then(function (registration) {
        registration.addEventListener('updatefound', () => {
          newWorker = registration.installing;
          newWorker.addEventListener('statechange', () => {
            switch (newWorker.state) {
              case 'installed':
                if (navigator.serviceWorker.controller) {
                  let notification = document.getElementById('notification');
                  notification.className = 'show';
                }
                break;
            }
          });
        });
      }).catch(function (err) {
        console.log("Service worker registration failed:", err);
      });
  }

  let refreshing;
  navigator.serviceWorker.addEventListener('controllerchange', function () {
    if (refreshing) return;
    window.location.reload();
    refreshing = true;
  });
</script>

</html>